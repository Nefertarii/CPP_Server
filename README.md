# C++ Server  
### 更新计划/Plan
[用于测试的服务器网站](http://webwasi.com/)      
[更新计划/内容](https://github.com/Nefertarii/WebServer/blob/master/ChangeLog.md)

### 项目背景/Background
在学习完相关知识后想将其整合，于是想到制作一个有交互功能，且考虑使用数据库存储相关数据的web服务器  
打算制作一个使用自制的数据库，并由多进程管理+多线程的服务器程序    
由此加深对基础知识的理解和大型项目制作过程的体验  
( 一开始考虑搭配unreal制作一款游戏并作为游戏服务器使用，要配套开发时间周期太长  
  目前结构也在向能使用不同协议方便扩展的运行方式而开发 )   
程序整体由管理进程控制数据库进程和服务器进程的启动以及启动时的设置  
也可单独使用数据库和服务器
作为我的第一个大型规划，后续会不断更新  

#### 整体构思
其中,项目的难点
- [ ] 打算从http升级成https处理(整体完成后考虑)
- [ ] 内存的分配(可以自动回收垃圾的垃圾回收器,预计和string类一起开发)
- [ ] 字符串的处理(底层对char* 的使用很多,来回转化不大美观且容易出错，实现一个贴合程序的string类)
- [ ] 数据库的制作(需要解决数据的问题，包括数据的储存和加载，还有不同模块和整体的整合是最需要考虑的部分,计划最后开发)

整体功能/模块大致构思：  
* 公共资源
	* 连接信息(当前的已连接用户表)
	* 本地日志(设置了本地日志后将存入队列,空闲时保存)
	* 设置信息(一些公共设置)
* 主线程	
	* 接收模块(所有包的接收)
	* socket模块(负责连接的建立,关闭)
	* 转发模块(将接收到的首个包转发给解析线程)
	* 日志模块(记录连接的信息)
* 解析线程	
	* 解析模块(解析请求包)
	* socket模块(负责维持进行中连接,和监听)
	* 权限模块(不同的权限由查询模块查询后解析)
	* 查询模块
		* 数据库查询(临时使用的数据库,后续需要修改查询可以独立操作)
		* 临时信息(分析的得到的,保存在内存中的常用数据)
		* 长久信息(由查询返回得来的字符串解析后即用即弃)
	* 响应处理模块(将解析后的请求包结合数据进行相应的处理)
	* 转发模块(将处理完成的信息打包转发给发送线程)
	* 日志模块(记录解析后所请求的信息)
* 发送线程	
	* socket模块(负责检测对段是否还存活,数据的发送)
	* 加密模块(没想好怎么用,也许与其他程序通信时能使用(仅做提名))
	* 日志模块(记录发送的结果)
* 日志线程(大型数据接收)
	* 接收模块
		* 本地(各模块收集的日志集中到任务队列中)
		* 远程(同本地保存逻辑一致,只是添加了TCP连接来获取或返回信息(暂不考虑制作远程储存))
	* 保存模块(空闲时/快达到上限时从任务队列中顺序保存至硬盘(快达到上限时保存可能会需要暂停接收))
	* 转发模块(需要远端保存时使用)  
(有些乱,过两天在建立框架的同时还会进行修改)

### 项目的安装及使用/Install & Usage
新版服务器的使用(还在开发中...)  

旧版服务器的使用(真的很烂,等新写的吧)   
项目编译使用了 Makefile  
在文件夹HTTPserver/build中为HTTP WEB服务器  
使用命令 ```make MODE=DEBUG``` 可启动调试模式，该模式下将直接输出各个处理的日志信息，且使用-Og编译  
直接使用命令 ```make``` 将会储存日志信息到文件中，并使用-O2编译  
启动时会根据目录下的Http.conf来设置相关参数  
若不绑定0\~1024端口，使用 ```./HTTPserver [conf file]``` 即可启动服务器进程  
绑定1\~1024端口需要添加权限，需使用 ```sudo ./HTTPserver [conf file]``` 才可成功启动  
如 ```./HTTPserver /home/ubuntu/Http.conf``` 启动HTTP WEB服务器。  

### 更新日志/Change log
[日志](https://github.com/Nefertarii/WebServer/blob/master/ChangeLog.md)

### 项目负责/Maintainers
[@Nefertarii](https://github.com/Nefertarii)  

### License
[MIT](https://github.com/Nefertarii/WebServer/blob/master/LICENSE) © Richard Littauer   
